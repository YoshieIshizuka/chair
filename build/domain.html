<!DOCTYPE HTML>

<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />

    <title>table</title>

    <script type="text/javascript" src="http://code.jquery.com/jquery-2.0.0.min.js"></script>

    <script type="text/javascript" src="chair.domain.js"></script>
    <script type="text/javascript" src="chair.infrastructure.js"></script>
    <script type="text/javascript" src="chair.application.js"></script>
    <script type="text/javascript" src="http://coffeescript.org/extras/coffee-script.js"></script>
</head>

<body>

<table id="table_table" class="table">
    <thead>
        <th>test</th>
        <th>test2</th>
    </thead>

    <tbody>
    </tbody>
</table>

<script type="text/coffeescript">
#
# Event subscription
#
DomainEvent.subscribe 'GridRowAppended', (event, eventName)->
    console.log "I got #{eventName}: #{JSON.stringify(event)}"

DomainEvent.subscribe 'GridRowSelected', (event, eventName)->
    console.log "I got #{eventName}: #{JSON.stringify(event)}"

DomainEvent.subscribe 'GridRowUnselected', (event, eventName)->
    console.log "I got #{eventName}: #{JSON.stringify(event)}"

DomainEvent.subscribe 'ColumnUpdated', (event, eventName)->
    console.log "I got #{eventName}: #{JSON.stringify(event)}"

#
# Domain logic example
#
formaters =
    right: (html)-> return '<div class="pull-right">'+html+'</div>'
    bold: (html)-> return '<strong>'+html+'</strong>'

grid = new Grid('that_grid_id', [
    new Column('name', "Onamae", [new ColumnFormat(formaters.right), new ColumnFormat(formaters.bold)])
    new Column('age', "Nenrei")
])

grid.append(new Row('line1', {name: "suin", age: 26}))
grid.append(new Row('line2', {name: "reoring", age: 300}))
grid.append(new Row('line3', {name: "nouphet", age: 30000}))

DomainRegistry.gridRepository().add(grid)

#
# Grid manipulation in client code
#
applicationGridService = new GridService()
applicationGridService.select('that_grid_id', 'that_row_id')
applicationGridService.updateColumn('that_grid_id', 'line1', 'name', 'suinyeze')
applicationGridService.updateColumn('that_grid_id', 'line1', 'age', '27')
applicationGridService.unselectAll('that_grid_id')
</script>

</body>
</html>
